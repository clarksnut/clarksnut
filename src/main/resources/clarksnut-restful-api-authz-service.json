{
  "allowRemoteResourceManagement": true,
  "policyEnforcementMode": "ENFORCING",
  "resources": [
    {
      "name": "User Self Profile Resource",
      "uri": "/api/profile",
      "type": "http://clarksnut.com/self-profile",
      "scopes": [
        {
          "name": "self-profile:view"
        }
      ]
    },
    {
      "name": "User Resource",
      "uri": "/api/users",
      "type": "http://clarksnut.com/users",
      "scopes": [
        {
          "name": "user:view"
        },
        {
          "name": "user:manage"
        }
      ]
    },
    {
      "name": "Space Resource",
      "uri": "/api/spaces",
      "type": "http://clarksnut.com/spaces",
      "scopes": [
        {
          "name": "space:view"
        },
        {
          "name": "space:manage"
        }
      ]
    },
    {
      "name": "Document Resource",
      "uri": "/api/documents",
      "type": "http://clarksnut.com/documents",
      "scopes": [
        {
          "name": "document:view"
        },
        {
          "name": "document:manage"
        }
      ]
    }
  ],
  "policies": [
    {
      "name": "Any User Policy",
      "description": "Defines that only users from well known clients are allowed to access",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"user\",\"required\":true}]"
      }
    },
    {
      "name": "Only Owner Policy",
      "description": "Defines that only the resource owner is allowed to do something",
      "type": "js",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "code": "var context = $evaluation.getContext();\nvar identity = context.getIdentity();\nvar permission = $evaluation.getPermission();\n\nif (permission.getResource() && permission.getResource().getOwner() == identity.getId()) {\n    $evaluation.grant();\n}"
      }
    },
    {
      "name": "View Self Profile Permission",
      "description": "Defines who is allowed to view an user self profile",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "scopes": "[\"self-profile:view\"]",
        "applyPolicies": "[\"Any User Policy\"]"
      }
    },
    {
      "name": "View User Permission",
      "description": "Defines who is allowed to view an user",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "scopes": "[\"user:view\"]",
        "applyPolicies": "[\"Any User Policy\"]"
      }
    },
    {
      "name": "Manage User Permission",
      "description": "Defines who is allowed to manage an user",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "scopes": "[\"user:manage\"]",
        "applyPolicies": "[\"Only Owner Policy\"]"
      }
    },
    {
      "name": "View Space Permission",
      "description": "Defines who is allowed to view an space",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "scopes": "[\"space:view\"]",
        "applyPolicies": "[\"Any User Policy\"]"
      }
    },
    {
      "name": "Manage Space Permission",
      "description": "Defines who is allowed to manage an space",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "scopes": "[\"space:manage\"]",
        "applyPolicies": "[\"Only Owner Policy\"]"
      }
    },
    {
      "name": "View Document Permission",
      "description": "Defines who is allowed to view a document",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "scopes": "[\"space:view\"]",
        "applyPolicies": "[\"Any User Policy\"]"
      }
    }
  ],
  "scopes": [
    {
      "name": "self-profile:view"
    },
    {
      "name": "user:view"
    },
    {
      "name": "user:manage"
    },
    {
      "name": "space:view"
    },
    {
      "name": "space:manage"
    }
  ]
}